<section data-transition="convex">
  <section>
    <h2>:has() Selector</h2>
    <div class="baseline-badge newly">üü° Newly Available (2024)</div>
    <p class="fragment">The <mark>parent selector</mark> is finally here!</p>
  </section>

  <section>
    <h3>What We've Always <mark>Wanted</mark></h3>
    <div class="before-after">
      <div class="before">
        <h4>‚ùå Before: JavaScript Required</h4>
        <pre><code class="language-javascript">// Select parent based on child
const forms = document.querySelectorAll('form');
forms.forEach(form => {
  if (form.querySelector('.error')) {
    form.classList.add('has-error');
  }
});

// Update on every change
input.addEventListener('input', () => {
  if (input.value) {
    input.parentElement.classList.add('has-value');
  }
});</code></pre>
        <pre><code class="language-css">/* Then style in CSS */
.form.has-error {
  border-color: red;
}

.field.has-value label {
  transform: translateY(-20px);
}</code></pre>
      </div>

      <div class="after">
        <h4>‚úÖ After: Pure CSS</h4>
        <pre><code class="language-css">/* Select parent that HAS error child */
form:has(.error) {
  border-color: red;
}

/* Float label when input has value */
.field:has(input:not(:placeholder-shown)) label {
  transform: translateY(-20px);
  font-size: 0.875rem;
}

/* Card with image */
.card:has(img) {
  display: grid;
  grid-template-columns: 200px 1fr;
}

/* Form with valid inputs */
form:has(input:valid) button {
  opacity: 1;
  pointer-events: auto;
}</code></pre>
      </div>
    </div>
  </section>

  <section>
    <h3>:has() <mark>Patterns</mark></h3>
    <div style="display: grid; gap: 1.5rem; margin-top: 2rem; font-size: 0.85rem;">
      <div class="fragment" style="background: #fef3c7; padding: 1.5rem; border-radius: 0.75rem; border: 2px solid #fbbf24;">
        <h4 style="margin-top: 0; color: #92400e;">üéØ Parent Selection</h4>
        <pre><code class="language-css">/* Article with featured image */
article:has(> img.featured) {
  display: grid;
  grid-template-areas: 
    "image title"
    "image content";
}

/* List item with checkbox */
li:has(input[type="checkbox"]:checked) {
  text-decoration: line-through;
  opacity: 0.6;
}</code></pre>
      </div>

      <div class="fragment" style="background: #fef3c7; padding: 1.5rem; border-radius: 0.75rem; border: 2px solid #fbbf24;">
        <h4 style="margin-top: 0; color: #92400e;">üìù Form States</h4>
        <pre><code class="language-css">/* Form with errors */
form:has(input:invalid) {
  border: 2px solid #ef4444;
}

/* Field with focus */
.field:has(input:focus) {
  background: #f0f9ff;
  border-color: #3b82f6;
}

/* Accordion expanded */
.accordion:has(input:checked) .content {
  max-height: 500px;
}</code></pre>
      </div>

      <div class="fragment" style="background: #fef3c7; padding: 1.5rem; border-radius: 0.75rem; border: 2px solid #fbbf24;">
        <h4 style="margin-top: 0; color: #92400e;">üé® Conditional Layouts</h4>
        <pre><code class="language-css">/* Grid adjusts if item has image */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
}

.grid:has(.item img) {
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
}

/* Sidebar layout if aside exists */
main:has(+ aside) {
  display: grid;
  grid-template-columns: 1fr 300px;
  gap: 2rem;
}</code></pre>
      </div>
    </div>
  </section>

  <section>
    <h3>Interactive <mark>Demo</mark></h3>
    <div class="demo" style="margin-top: 2rem;">
      <style>
        .demo-has-container {
          max-width: 600px;
          margin: 0 auto;
        }
        
        .demo-has-field {
          position: relative;
          margin-bottom: 1.5rem;
        }
        
        .demo-has-field input {
          width: 100%;
          padding: 1rem 1rem 0.5rem;
          border: 2px solid #e2e8f0;
          border-radius: 0.5rem;
          font-size: 1rem;
          transition: all 0.2s;
        }
        
        .demo-has-field label {
          position: absolute;
          left: 1rem;
          top: 1rem;
          color: #64748b;
          transition: all 0.2s;
          pointer-events: none;
        }
        
        /* :has() magic! */
        .demo-has-field:has(input:focus) {
          transform: scale(1.02);
        }
        
        .demo-has-field:has(input:focus) input {
          border-color: #667eea;
          box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .demo-has-field:has(input:not(:placeholder-shown)) label,
        .demo-has-field:has(input:focus) label {
          top: 0.25rem;
          font-size: 0.75rem;
          color: #667eea;
        }
        
        .demo-has-form button {
          width: 100%;
          padding: 0.75rem;
          background: #667eea;
          color: white;
          border: none;
          border-radius: 0.5rem;
          font-size: 1rem;
          font-weight: 600;
          opacity: 0.5;
          pointer-events: none;
          transition: opacity 0.2s;
        }
        
        .demo-has-form:has(input:not(:placeholder-shown)) button {
          opacity: 1;
          pointer-events: auto;
          cursor: pointer;
        }
        
        .demo-has-form:has(input:not(:placeholder-shown)) button:hover {
          background: #5568d3;
        }
      </style>
      
      <div class="demo-has-container">
        <form class="demo-has-form" onsubmit="event.preventDefault(); alert('Form submitted!');">
          <div class="demo-has-field">
            <input type="text" placeholder=" " id="demo-name">
            <label for="demo-name">Your Name</label>
          </div>
          
          <div class="demo-has-field">
            <input type="email" placeholder=" " id="demo-email">
            <label for="demo-email">Email Address</label>
          </div>
          
          <button type="submit">Submit</button>
        </form>
        
        <div style="margin-top: 2rem; padding: 1.5rem; background: #f8fafc; border-radius: 0.75rem; border: 2px solid #e2e8f0; font-size: 0.9rem;">
          <h4 style="margin: 0 0 1rem; color: #1e293b;">‚ú® Pure CSS Features:</h4>
          <ul style="margin: 0; padding-left: 1.5rem; color: #64748b;">
            <li>Floating labels on focus/value</li>
            <li>Field scaling on focus</li>
            <li>Button enabled when both fields have values</li>
            <li>All with <code>:has()</code> - no JavaScript!</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <section>
    <h3>Advanced <mark>Techniques</mark></h3>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 2rem; font-size: 0.8rem;">
      <div class="fragment" style="background: #fef3c7; padding: 1.5rem; border-radius: 0.75rem; border: 2px solid #fbbf24;">
        <h4 style="margin-top: 0; color: #92400e;">üîó Sibling Selection</h4>
        <pre><code class="language-css">/* Previous sibling (yes, really!) */
li:has(+ li:hover) {
  color: #667eea;
}

/* Parent of hovered child */
ul:has(li:hover) {
  background: #f8fafc;
}</code></pre>
      </div>

      <div class="fragment" style="background: #fef3c7; padding: 1.5rem; border-radius: 0.75rem; border: 2px solid #fbbf24;">
        <h4 style="margin-top: 0; color: #92400e;">üé≠ Negation</h4>
        <pre><code class="language-css">/* Article WITHOUT image */
article:not(:has(img)) {
  max-width: 65ch;
}

/* Form with NO errors */
form:not(:has(.error)) {
  border-color: #10b981;
}</code></pre>
      </div>

      <div class="fragment" style="background: #fef3c7; padding: 1.5rem; border-radius: 0.75rem; border: 2px solid #fbbf24;">
        <h4 style="margin-top: 0; color: #92400e;">üìä Quantity Queries</h4>
        <pre><code class="language-css">/* Grid with 4+ items */
ul:has(li:nth-child(4)) {
  grid-template-columns: repeat(2, 1fr);
}

/* Grid with 9+ items */
ul:has(li:nth-child(9)) {
  grid-template-columns: repeat(3, 1fr);
}</code></pre>
      </div>

      <div class="fragment" style="background: #fef3c7; padding: 1.5rem; border-radius: 0.75rem; border: 2px solid #fbbf24;">
        <h4 style="margin-top: 0; color: #92400e;">üéØ Complex Selectors</h4>
        <pre><code class="language-css">/* Card with checked checkbox in header */
.card:has(header input:checked) {
  background: #d1fae5;
  border-color: #10b981;
}

/* Section with multiple specific children */
section:has(h2):has(img):has(code) {
  /* Style sections with all three */
}</code></pre>
      </div>
    </div>
  </section>
</section>
